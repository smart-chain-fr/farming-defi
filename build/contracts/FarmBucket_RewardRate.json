{
  "contractName": "FarmBucket_RewardRate",
  "abi": [],
  "michelson": "[ { \"prim\": \"parameter\",\n    \"args\":\n      [ { \"prim\": \"or\",\n          \"args\":\n            [ { \"prim\": \"or\",\n                \"args\":\n                  [ { \"prim\": \"or\",\n                      \"args\":\n                        [ { \"prim\": \"address\", \"annots\": [ \"%changeAdmin\" ] },\n                          { \"prim\": \"unit\", \"annots\": [ \"%claim\" ] } ] },\n                    { \"prim\": \"or\",\n                      \"args\":\n                        [ { \"prim\": \"nat\", \"annots\": [ \"%stake\" ] },\n                          { \"prim\": \"nat\", \"annots\": [ \"%unstake\" ] } ] } ] },\n              { \"prim\": \"pair\",\n                \"args\":\n                  [ { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"nat\", \"annots\": [ \"%mint_min_amount\" ] },\n                          { \"prim\": \"nat\",\n                            \"annots\": [ \"%mint_rate_permil\" ] } ] },\n                    { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"nat\", \"annots\": [ \"%reward_rate\" ] },\n                          { \"prim\": \"nat\",\n                            \"annots\": [ \"%reward_stake_divisor\" ] } ] } ],\n                \"annots\": [ \"%updateConfig\" ] } ] } ] },\n  { \"prim\": \"storage\",\n    \"args\":\n      [ { \"prim\": \"pair\",\n          \"args\":\n            [ { \"prim\": \"pair\",\n                \"args\":\n                  [ { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"big_map\",\n                            \"args\":\n                              [ { \"prim\": \"address\" },\n                                { \"prim\": \"pair\",\n                                  \"args\":\n                                    [ { \"prim\": \"pair\",\n                                        \"args\":\n                                          [ { \"prim\": \"timestamp\",\n                                              \"annots\":\n                                                [ \"%last_reward_time\" ] },\n                                            { \"prim\": \"nat\",\n                                              \"annots\": [ \"%reward_amount\" ] } ] },\n                                      { \"prim\": \"nat\",\n                                        \"annots\": [ \"%stake_amount\" ] } ] } ],\n                            \"annots\": [ \"%accounts\" ] },\n                          { \"prim\": \"address\", \"annots\": [ \"%admin\" ] } ] },\n                    { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"pair\",\n                            \"args\":\n                              [ { \"prim\": \"pair\",\n                                  \"args\":\n                                    [ { \"prim\": \"nat\",\n                                        \"annots\": [ \"%mint_min_amount\" ] },\n                                      { \"prim\": \"nat\",\n                                        \"annots\": [ \"%mint_rate_permil\" ] } ] },\n                                { \"prim\": \"pair\",\n                                  \"args\":\n                                    [ { \"prim\": \"nat\",\n                                        \"annots\": [ \"%reward_rate\" ] },\n                                      { \"prim\": \"nat\",\n                                        \"annots\": [ \"%reward_stake_divisor\" ] } ] } ],\n                            \"annots\": [ \"%config\" ] },\n                          { \"prim\": \"timestamp\",\n                            \"annots\": [ \"%last_update_time\" ] } ] } ] },\n              { \"prim\": \"pair\",\n                \"args\":\n                  [ { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"address\",\n                            \"annots\": [ \"%reward_token\" ] },\n                          { \"prim\": \"address\", \"annots\": [ \"%token\" ] } ] },\n                    { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"nat\",\n                            \"annots\": [ \"%total_reward_paid\" ] },\n                          { \"prim\": \"nat\", \"annots\": [ \"%total_stack\" ] } ] } ] } ] } ] },\n  { \"prim\": \"code\",\n    \"args\":\n      [ [ { \"prim\": \"LAMBDA\",\n            \"args\":\n              [ { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"pair\",\n                        \"args\": [ { \"prim\": \"nat\" }, { \"prim\": \"address\" } ] },\n                      { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"address\" }, { \"prim\": \"address\" } ] } ] },\n                { \"prim\": \"list\", \"args\": [ { \"prim\": \"operation\" } ] },\n                [ { \"prim\": \"NIL\", \"args\": [ { \"prim\": \"operation\" } ] },\n                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                  { \"prim\": \"CONTRACT\",\n                    \"args\":\n                      [ { \"prim\": \"list\",\n                          \"args\":\n                            [ { \"prim\": \"pair\",\n                                \"args\":\n                                  [ { \"prim\": \"address\",\n                                      \"annots\": [ \"%from_\" ] },\n                                    { \"prim\": \"list\",\n                                      \"args\":\n                                        [ { \"prim\": \"pair\",\n                                            \"args\":\n                                              [ { \"prim\": \"address\",\n                                                  \"annots\": [ \"%to_\" ] },\n                                                { \"prim\": \"pair\",\n                                                  \"args\":\n                                                    [ { \"prim\": \"nat\",\n                                                        \"annots\":\n                                                          [ \"%token_id\" ] },\n                                                      { \"prim\": \"nat\",\n                                                        \"annots\":\n                                                          [ \"%amount\" ] } ] } ] } ],\n                                      \"annots\": [ \"%txs\" ] } ] } ] } ],\n                    \"annots\": [ \"%transfer\" ] },\n                  { \"prim\": \"IF_NONE\",\n                    \"args\":\n                      [ [ { \"prim\": \"PUSH\",\n                            \"args\":\n                              [ { \"prim\": \"string\" },\n                                { \"string\": \"FA2_TOKEN_NOT_FOUND\" } ] },\n                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                  { \"prim\": \"PUSH\",\n                    \"args\": [ { \"prim\": \"mutez\" }, { \"int\": \"0\" } ] },\n                  { \"prim\": \"NIL\",\n                    \"args\":\n                      [ { \"prim\": \"pair\",\n                          \"args\":\n                            [ { \"prim\": \"address\" },\n                              { \"prim\": \"list\",\n                                \"args\":\n                                  [ { \"prim\": \"pair\",\n                                      \"args\":\n                                        [ { \"prim\": \"address\" },\n                                          { \"prim\": \"pair\",\n                                            \"args\":\n                                              [ { \"prim\": \"nat\" },\n                                                { \"prim\": \"nat\" } ] } ] } ] } ] } ] },\n                  { \"prim\": \"NIL\",\n                    \"args\":\n                      [ { \"prim\": \"pair\",\n                          \"args\":\n                            [ { \"prim\": \"address\" },\n                              { \"prim\": \"pair\",\n                                \"args\":\n                                  [ { \"prim\": \"nat\" }, { \"prim\": \"nat\" } ] } ] } ] },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"5\" } ] },\n                  { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"6\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                  { \"prim\": \"PUSH\",\n                    \"args\": [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                  { \"prim\": \"PAIR\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"6\" } ] },\n                  { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"7\" } ] },\n                  { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                  { \"prim\": \"CONS\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"5\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" }, { \"prim\": \"PAIR\" },\n                  { \"prim\": \"CONS\" }, { \"prim\": \"TRANSFER_TOKENS\" },\n                  { \"prim\": \"CONS\" } ] ] },\n          { \"prim\": \"LAMBDA\",\n            \"args\":\n              [ { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"address\" },\n                      { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"pair\",\n                              \"args\":\n                                [ { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"big_map\",\n                                          \"args\":\n                                            [ { \"prim\": \"address\" },\n                                              { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"pair\",\n                                                      \"args\":\n                                                        [ { \"prim\":\n                                                              \"timestamp\" },\n                                                          { \"prim\": \"nat\" } ] },\n                                                    { \"prim\": \"nat\" } ] } ] },\n                                        { \"prim\": \"address\" } ] },\n                                  { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"pair\",\n                                          \"args\":\n                                            [ { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"nat\" },\n                                                    { \"prim\": \"nat\" } ] },\n                                              { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"nat\" },\n                                                    { \"prim\": \"nat\" } ] } ] },\n                                        { \"prim\": \"timestamp\" } ] } ] },\n                            { \"prim\": \"pair\",\n                              \"args\":\n                                [ { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"address\" },\n                                        { \"prim\": \"address\" } ] },\n                                  { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" },\n                                        { \"prim\": \"nat\" } ] } ] } ] } ] },\n                { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"timestamp\" }, { \"prim\": \"nat\" } ] },\n                      { \"prim\": \"nat\" } ] },\n                [ { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" }, { \"prim\": \"SWAP\" },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"SWAP\" }, { \"prim\": \"CAR\" },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" }, { \"prim\": \"SWAP\" },\n                  { \"prim\": \"GET\" },\n                  { \"prim\": \"IF_NONE\",\n                    \"args\":\n                      [ [ { \"prim\": \"PUSH\",\n                            \"args\": [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                          { \"prim\": \"PUSH\",\n                            \"args\": [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                          { \"prim\": \"NOW\" }, { \"prim\": \"PAIR\" },\n                          { \"prim\": \"PAIR\" } ], [] ] } ] ] },\n          { \"prim\": \"LAMBDA\",\n            \"args\":\n              [ { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"pair\",\n                              \"args\":\n                                [ { \"prim\": \"timestamp\" },\n                                  { \"prim\": \"nat\" } ] }, { \"prim\": \"nat\" } ] },\n                      { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"pair\",\n                              \"args\":\n                                [ { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"big_map\",\n                                          \"args\":\n                                            [ { \"prim\": \"address\" },\n                                              { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"pair\",\n                                                      \"args\":\n                                                        [ { \"prim\":\n                                                              \"timestamp\" },\n                                                          { \"prim\": \"nat\" } ] },\n                                                    { \"prim\": \"nat\" } ] } ] },\n                                        { \"prim\": \"address\" } ] },\n                                  { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"pair\",\n                                          \"args\":\n                                            [ { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"nat\" },\n                                                    { \"prim\": \"nat\" } ] },\n                                              { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"nat\" },\n                                                    { \"prim\": \"nat\" } ] } ] },\n                                        { \"prim\": \"timestamp\" } ] } ] },\n                            { \"prim\": \"pair\",\n                              \"args\":\n                                [ { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"address\" },\n                                        { \"prim\": \"address\" } ] },\n                                  { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" },\n                                        { \"prim\": \"nat\" } ] } ] } ] } ] },\n                { \"prim\": \"nat\" },\n                [ { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" }, { \"prim\": \"SWAP\" },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" }, { \"prim\": \"SWAP\" },\n                  { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" }, { \"prim\": \"NOW\" },\n                  { \"prim\": \"SUB\" }, { \"prim\": \"ABS\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                  { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n                  { \"prim\": \"CDR\" }, { \"prim\": \"MUL\" }, { \"prim\": \"MUL\" },\n                  { \"prim\": \"EDIV\" },\n                  { \"prim\": \"IF_NONE\",\n                    \"args\":\n                      [ [ { \"prim\": \"PUSH\",\n                            \"args\":\n                              [ { \"prim\": \"string\" },\n                                { \"string\": \"DIV by 0\" } ] },\n                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                  { \"prim\": \"CAR\" } ] ] },\n          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] }, { \"prim\": \"DUP\" },\n          { \"prim\": \"CDR\" }, { \"prim\": \"SWAP\" }, { \"prim\": \"CAR\" },\n          { \"prim\": \"IF_LEFT\",\n            \"args\":\n              [ [ { \"prim\": \"IF_LEFT\",\n                    \"args\":\n                      [ [ { \"prim\": \"IF_LEFT\",\n                            \"args\":\n                              [ [ { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DROP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DROP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DROP\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"COMPARE\" }, { \"prim\": \"NEQ\" },\n                                  { \"prim\": \"IF\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"DROP\" },\n                                          { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\": \"SF_DENIED\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ],\n                                        [ { \"prim\": \"SWAP\" },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"CDR\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"CAR\" },\n                                          { \"prim\": \"CDR\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"CAR\" },\n                                          { \"prim\": \"CAR\" },\n                                          { \"prim\": \"CAR\" },\n                                          { \"prim\": \"PAIR\" },\n                                          { \"prim\": \"PAIR\" },\n                                          { \"prim\": \"PAIR\" } ] ] },\n                                  { \"prim\": \"NIL\",\n                                    \"args\": [ { \"prim\": \"operation\" } ] },\n                                  { \"prim\": \"PAIR\" } ],\n                                [ { \"prim\": \"DROP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"NOW\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"COMPARE\" }, { \"prim\": \"EQ\" },\n                                  { \"prim\": \"IF\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\":\n                                                    \"SF_EMPTY_REWARDS\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"6\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SOME\" }, { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"UPDATE\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"ADD\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"NOW\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SELF\" }, { \"prim\": \"ADDRESS\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" },\n                                        { \"int\": \"1000\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"MUL\" },\n                                  { \"prim\": \"EDIV\" },\n                                  { \"prim\": \"IF_NONE\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\": \"DIV by 0\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"ADD\" },\n                                  { \"prim\": \"NIL\",\n                                    \"args\":\n                                      [ { \"prim\": \"pair\",\n                                          \"args\":\n                                            [ { \"prim\": \"nat\" },\n                                              { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"address\" },\n                                                    { \"prim\": \"nat\" } ] } ] } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"SELF\" },\n                                  { \"prim\": \"ADDRESS\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"CONS\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CONTRACT\",\n                                    \"args\":\n                                      [ { \"prim\": \"list\",\n                                          \"args\":\n                                            [ { \"prim\": \"pair\",\n                                                \"args\":\n                                                  [ { \"prim\": \"nat\",\n                                                      \"annots\":\n                                                        [ \"%token_id\" ] },\n                                                    { \"prim\": \"pair\",\n                                                      \"args\":\n                                                        [ { \"prim\": \"address\",\n                                                            \"annots\":\n                                                              [ \"%user\" ] },\n                                                          { \"prim\": \"nat\",\n                                                            \"annots\":\n                                                              [ \"%amount\" ] } ] } ] } ] } ],\n                                    \"annots\": [ \"%mint\" ] },\n                                  { \"prim\": \"IF_NONE\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\":\n                                                    \"FA2_TOKEN_NOT_FOUND\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"mutez\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"TRANSFER_TOKENS\" },\n                                  { \"prim\": \"CONS\" }, { \"prim\": \"PAIR\" } ] ] } ],\n                        [ { \"prim\": \"IF_LEFT\",\n                            \"args\":\n                              [ [ { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"ADD\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"NOW\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"ADD\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SOME\" }, { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"UPDATE\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"ADD\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"NOW\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"SELF\" }, { \"prim\": \"ADDRESS\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"PAIR\" } ],\n                                [ { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"ADD\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"NOW\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"COMPARE\" }, { \"prim\": \"EQ\" },\n                                  { \"prim\": \"IF\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"DUP\" },\n                                          { \"prim\": \"CDR\" } ],\n                                        [ { \"prim\": \"SWAP\" },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"2\" } ] } ] ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"COMPARE\" }, { \"prim\": \"GT\" },\n                                  { \"prim\": \"IF\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\":\n                                                    \"SF_INSUFFICIENT_BALANCE\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"SUB\" },\n                                  { \"prim\": \"ABS\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SOME\" }, { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"UPDATE\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"SUB\" },\n                                  { \"prim\": \"ABS\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"NOW\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DUP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SELF\" }, { \"prim\": \"ADDRESS\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"PAIR\" } ] ] } ] ] } ],\n                [ { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"DROP\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"DROP\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"DROP\" }, { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                  { \"prim\": \"SENDER\" }, { \"prim\": \"COMPARE\" },\n                  { \"prim\": \"NEQ\" },\n                  { \"prim\": \"IF\",\n                    \"args\":\n                      [ [ { \"prim\": \"PUSH\",\n                            \"args\":\n                              [ { \"prim\": \"string\" },\n                                { \"string\": \"SF_DENIED\" } ] },\n                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"CDR\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"DUP\" },\n                  { \"prim\": \"DUG\", \"args\": [ { \"int\": \"3\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"PAIR\" },\n                  { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                  { \"prim\": \"PAIR\" },\n                  { \"prim\": \"NIL\", \"args\": [ { \"prim\": \"operation\" } ] },\n                  { \"prim\": \"PAIR\" } ] ] } ] ] } ]",
  "source": "//////////////////////////////\n// single token farm bucket\n// reward amount is rate of staked amount for account\n//////////////////////////////\n\ntype farm_config is record [\n  reward_rate: nat;            // reward per x share per sec in micro tokens. So reward in utokens = (stake_amount * reward_rate * sec) / reward_stake_divisor\n  reward_stake_divisor: nat;\n  mint_rate_permil: nat;       // permill of acc reward to mint\n  mint_min_amount: nat;        // static minimum mint amount per second\n]\n\ntype farmer_account is record [\n  stake_amount: nat;\n  reward_amount: nat;\n  last_reward_time: timestamp;\n]\n\ntype storage is record [\n  admin: address;\n  token: address;                             // this bucket token to stake\n  reward_token: address;                      // token for rewards\n  config: farm_config;                        // rates configuration \n  accounts: big_map(address, farmer_account); // accounts invested in farm\n  total_stack: nat;\n  total_reward_paid: nat;\n  last_update_time: timestamp;\n]\n\n//+ FA2 ops\ntype transfer_destination is [@layout:comb] record [\n  to_                 : address;\n  token_id            : nat;\n  amount              : nat;\n]\n\ntype transfer_param is [@layout:comb] record [\n  from_               : address;\n  txs                 : list(transfer_destination);\n]\ntype transfer_type is Transfer of list(transfer_param)\n\nfunction get_token_transfer_entrypoint(const token : address) : contract(transfer_type) is\n  case (Tezos.get_entrypoint_opt(\"%transfer\", token) : option(contract(transfer_type))) of\n    | Some(c) -> c\n    | None -> (failwith(\"FA2_TOKEN_NOT_FOUND\") : contract(transfer_type))\n  end;\n\ntype t_args is record [\n  token: address;         // FA2 contract address\n  from_addr: address;     // according to FA2 permission policy must be an operator on token contract\n  to_addr: address;       // target token account\n  amount: nat;\n]\n\nfunction call_transfer_op(const params: t_args) : list(operation) is \n  block {\n    var ops : list(operation):= nil;\n    ops := Tezos.transaction(\n        Transfer(list [record [\n          from_ = params.from_addr;\n          txs = list [\n              record [\n                to_ = params.to_addr;\n                token_id = 0n;\n                amount = params.amount;\n              ]\n            ]\n          ]]),\n        0tez,\n        get_token_transfer_entrypoint(params.token)\n    ) # ops;\n  } with(ops)\n\ntype mint_param is [@layout:comb] record [\n  token_id        : nat;\n  user            : address;\n  amount          : nat;\n]\n\ntype mint_params is list(mint_param)\n\ntype mint_type is Mint of mint_params\nfunction get_token_mint_entrypoint(const token : address) : contract(mint_type) is\n  case (Tezos.get_entrypoint_opt(\"%mint\", token) : option(contract(mint_type))) of\n    | Some(c) -> c\n    | None -> (failwith(\"FA2_TOKEN_NOT_FOUND\") : contract(mint_type))\n  end;\n\nfunction call_mint_op(const token : address; const params : mint_params) : operation is\n  Tezos.transaction(\n      Mint(params),\n      0tez,\n      get_token_mint_entrypoint(token)\n  )\n    \n//- FA2 ops\n\nfunction change_admin(const acc: address; var s: storage): storage is \n  block {\n      if Tezos.sender =/= s.admin then\n        failwith(\"SF_DENIED\")\n      else\n        s.admin := acc;\n  } with (s)\n\nfunction get_farmer(const acc: address; const s: storage) : farmer_account is \n    case s.accounts[acc] of\n    | Some(a) -> a\n    | None -> record[\n        stake_amount = 0n;\n        reward_amount = 0n;\n        last_reward_time = Tezos.now;\n    ]\n    end\n\nfunction calc_reward_addition(const acc: farmer_account; const s: storage): nat is \n  (acc.stake_amount * s.config.reward_rate * abs(Tezos.now - acc.last_reward_time)) / s.config.reward_stake_divisor;\n\nfunction mint(const reward_amount: nat; const s: storage): operation is \n  block {\n    var mint_amount := (s.config.mint_rate_permil * reward_amount) / 1000n + s.config.mint_min_amount;\n    \n  } with(call_mint_op(s.reward_token, list[record[token_id = 0n; user = Tezos.self_address; amount = mint_amount]]))\n\nfunction stake(const token_amount: nat; var s: storage): list(operation) * storage is \n  block {\n    var acc := get_farmer(Tezos.sender, s);\n    var reward_increase := calc_reward_addition(acc, s);\n    acc.reward_amount := acc.reward_amount + reward_increase;\n    acc.last_reward_time := Tezos.now;\n    acc.stake_amount := acc.stake_amount + token_amount;\n    \n    s.accounts[Tezos.sender] := acc;\n    // contract summaries info\n    s.total_stack := s.total_stack + token_amount;\n    s.last_update_time := Tezos.now;\n\n    var ops := call_transfer_op(record [token = s.token; from_addr = Tezos.sender; to_addr = Tezos.self_address; amount = token_amount]);\n  } with(ops, s)\n\nfunction unstake(const token_amount: nat; var s: storage): list(operation) * storage is \n  block {\n    var acc := get_farmer(Tezos.sender, s);\n    var reward_increase := calc_reward_addition(acc, s);\n    acc.reward_amount := acc.reward_amount + reward_increase;\n    acc.last_reward_time := Tezos.now;\n    var eff_token_amount : nat := 0n;\n    if token_amount = 0n then\n      eff_token_amount := acc.stake_amount;\n    else\n      eff_token_amount := token_amount;\n    \n    if token_amount > acc.stake_amount then\n      failwith(\"SF_INSUFFICIENT_BALANCE\");\n    else\n      skip;\n      \n    acc.stake_amount := abs(acc.stake_amount - eff_token_amount);\n    s.accounts[Tezos.sender] := acc;\n\n    // contract summaries info\n    s.total_stack := abs(s.total_stack - eff_token_amount);\n    s.last_update_time := Tezos.now;\n\n    var ops := call_transfer_op(record [token = s.token; from_addr = Tezos.self_address; to_addr = Tezos.sender; amount = eff_token_amount]);\n  } with(ops, s)\n\n// transfer whole account reward amount\nfunction claim(var s: storage): list(operation) * storage is \n  block {\n    var acc := get_farmer(Tezos.sender, s);\n    var reward_to_pay := calc_reward_addition(acc, s);\n    acc.last_reward_time := Tezos.now;\n\n    if reward_to_pay = 0n then\n      failwith(\"SF_EMPTY_REWARDS\");\n    else\n      skip;\n    acc.reward_amount := 0n;\n    s.accounts[Tezos.sender] := acc;\n\n    // contract summaries info\n    s.total_reward_paid := s.total_reward_paid + reward_to_pay;\n    s.last_update_time := Tezos.now;\n    var ops := call_transfer_op(record [token = s.reward_token; from_addr = Tezos.self_address; to_addr = Tezos.sender; amount = reward_to_pay]);\n    ops := mint(reward_to_pay, s) # ops;\n  } with(ops, s)\n\nfunction update_config(const config : farm_config; var s: storage) : storage is\n  block {\n    if Tezos.sender =/= s.admin then\n      failwith(\"SF_DENIED\");\n    else\n      skip;\n    s.config := config;\n  } with(s)\n\n\ntype action is \n  | ChangeAdmin of address\n  | Stake of nat\n  | Unstake of nat\n  | Claim of unit\n  | UpdateConfig of farm_config\n\nfunction main(const action : action; const s : storage) : list(operation) * storage  is\n  case action of\n  | ChangeAdmin(args)  -> ((nil : list(operation)), change_admin(args, s))\n  | UpdateConfig(args) -> ((nil : list(operation)), update_config(args, s))\n  | Stake(args)        -> stake(args, s)\n  | Unstake(args)      -> unstake(args, s)\n  | Claim              -> claim(s)\n  end\n",
  "sourcePath": "/home/helder/Documents/GitHub/farming-defi/contracts/main/farm/FarmBucket_RewardRate.ligo",
  "compiler": {
    "name": "ligo",
    "version": "next"
  },
  "networks": {},
  "schemaVersion": "3.2.0-tezos.1",
  "updatedAt": "2021-10-07T09:02:53.228Z"
}